"use strict";function misc_tweaks(){$('abbr.mobi').each(function(index,item){$(item).on('touchstart',function(evt){var tt=$(this).children('span');tt.show();setTimeout(function(){tt.hide();},1500);});});var btns=document.querySelectorAll('button[data-action-uri]'),i;for(i=0;i<btns.length;i++){btns[i].addEventListener('click',function(evt){var uri=evt.target.getAttribute('data-action-uri');window.location.href=uri;});}}
function setup_liv(){var charts=[],spl=[];var body=$('body');if(body.hasClass('details')&&body.hasClass('liv')){update_score_comparison();commute_calc();var ams_completed=function(ams_sc){up_cnts(ams_sc);};if(window.g_refined_loc&&(window.g_refined_loc.addr||window.g_refined_loc.zip)){var els=[$('.score-map em')];var plc_txt=$('.score-panel:eq(0) h2');var txt=window.g_refined_loc.addr||window.g_refined_loc.zip||'';if(txt)txt+=', ';txt+=plc_txt.text();plc_txt.text(txt.trim());var spin=scores_spinner(els);spin.start();ams_completed=function(ams_sc){var params={ams:ams_sc.join(','),sub:g_subt[0]};$.ajax({type:'get',dataType:'json',url:'/ax_recalc_ams/',data:params}).done(function(res){spin.stop(res[1]);$('.score-panel:eq(0) strong').text(res[3]);});up_cnts(ams_sc);};}
var am=amenities_map($('#js-am-map'),ams_completed);var up_cnts=amenities_hider(am.visibility);}
if(body.hasClass('details')){var tc;zw_list_builder();zw_form('rlt');if(body.hasClass('liv')||body.hasClass('cri')||body.hasClass('ams')||body.hasClass('col')||body.hasClass('edu')||body.hasClass('emp')||body.hasClass('hou')||body.hasClass('wea')||body.hasClass('dem')){city_compare_search();}
if(body.hasClass('ams')){var am=amenities_map($('#js-am-map'),function(ams_sc){up_cnts(ams_sc);});var up_cnts=amenities_hider(am.visibility);}
if(body.hasClass('cri')){tc=create_daily_crime_graph(daily_crimes);charts=charts.concat(tc);tc=create_crime_rank_graph(crime_ranking);charts=charts.concat(tc);tc=create_yy_crime_graph(yy_crime);charts=charts.concat(tc);setup_adt();}
if(body.hasClass('edu')){tc=create_highest_edu_level_graph(highest_edu);charts=charts.concat(tc);schools_mapper(document.querySelector('.school-panel'));}
if(body.hasClass('sdt')){update_score_comparison();tc=create_prof_math(prof_math);charts=charts.concat(tc);tc=create_prof_read(prof_read);charts=charts.concat(tc);}
if(body.hasClass('emp')){tc=create_work_type_graph(work_type);charts=charts.concat(tc);tc=create_hours_worked_graph(hours_worked);charts=charts.concat(tc);tc=create_wage_bracket_graph(wage_brackets);charts=charts.concat(tc);ami_midclass();}
if(body.hasClass('hou')){tc=create_vac_occ_lvls_graph(vac_occ_lvls);charts=charts.concat(tc);tc=create_vac_breakdown_graph(vac_breakdown);charts=charts.concat(tc);tc=create_home_stats_graph(home_stats);charts=charts.concat(tc);tc=create_heat_methods_graph(heat_methods);charts=charts.concat(tc);create_rent_income_ratio_graph(rent_income_ratio);charts=charts.concat(tc);create_util_rent_inc_graph(util_rent_inc);charts=charts.concat(tc);}
if(body.hasClass('wea')){tc=create_avg_temps_graph(avg_temps);charts=charts.concat(tc);tc=create_precip_acc_graph(precip_acc);charts=charts.concat(tc);tc=create_snow_acc_graph(snow_acc);charts=charts.concat(tc);tc=create_wind_speed_graph(wind_speed);charts=charts.concat(tc);}
if(body.hasClass('dem')){tc=create_lang_split_graph(lang_split);charts=charts.concat(tc);tc=create_res_origin_graph(res_origin);charts=charts.concat(tc);tc=create_inc_range_graph(inc_range);charts=charts.concat(tc);tc=create_inc_source_graph(inc_source);charts=charts.concat(tc);tc=create_age_split_graph(age_split);charts=charts.concat(tc);tc=create_marital_graph(marital);charts=charts.concat(tc);tc=create_offspring_graph(offspring);charts=charts.concat(tc);}
if(body.hasClass('tra')){commute_calc();tc=create_com_meth_graph(com_meth);charts=charts.concat(tc);tc=create_com_time_graph(com_time);charts=charts.concat(tc);}
if(body.hasClass('cdt')){tc=create_coll_enroll(college_enroll);charts=charts.concat(tc);tc=create_coll_degree(college_degree);charts=charts.concat(tc);}}
if(body.hasClass('search')){if(body.hasClass('state')){zw_form('rlt');}
var use_trans=document.querySelector('.use-transpose');if(use_trans){var lsts=document.querySelectorAll('ul.stacked-place-list');var n=window.getComputedStyle(use_trans).getPropertyValue('z-index');n=parseInt(n,10);if(body.hasClass('state')){columnize(lsts[0],n);columnize(lsts[1],n);columnize(lsts[2],n);}
else{columnize(lsts[0],n);}}
fittext();var ll=lazy_loader('/photos/state/');ll.append('.pretty-header');ll.update();$(window).on('scroll',debounce(ll.update));}
$(window).on('resize',debounce(function(e){if(charts.length){for(var i=0;i<charts.length;i++){charts[i].resize();}}
if(spl.length){for(var i=0;i<spl.length;i++){spl[i].transpose();}}
fittext();}));misc_tweaks();}
doc_ready(function(){setup_liv();});